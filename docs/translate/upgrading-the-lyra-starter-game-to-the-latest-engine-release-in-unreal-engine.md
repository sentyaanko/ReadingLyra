> これは [Unreal Engine 5.1 Documentation > サンプルとチュートリアル > サンプル ゲーム プロジェクト > Lyra サンプル ゲーム > Upgrading the Lyra Starter Game to the Latest Engine Release] の翻訳したものです。  
> (2022/12/05 時点で翻訳されていないため暫定作成)  
> リンクなどは省略していますので、詳しい情報は上記の公式ドキュメントを参照してください。


# Upgrading the Lyra Starter Game to the Latest Engine Release

各エンジン バージョンの Lyra の主な変更点を説明し、既存のゲームをアップグレードして最新の Unreal Engine 5 を活用するのに役立つ情報が記載されています。

Lyra スターター ゲームは、Unreal Engine のメジャー リリースごとに更新されています。
このページでは、各エンジン バージョンの Lyra に加えられた主な変更点を説明し、既存のゲームを Unreal Engine 5 の最新リリースにアップグレードする際に役立つ情報を掲載しています。


# 最新のエンジンリリースへのアップグレード

C++ コードを含む Lyra のようなゲームは、Unreal engine の新しいメジャーリリースで正しく動作させるために、手動でのアップデートが必要になります。  
エンジンの 5.0.x から 5.1.x へのメジャー アップグレードでは、古い機能や設定が非推奨となり、プロジェクトで使用されている既存の関数や変数が変更される可能性があります。  
そのため、ゲーム固有のコードとデータの一部は、アップグレード後に正しく動作するように更新する必要があります。  

Lyra を例にとると、以下の手順でゲームを更新することができます:  

1. 新しいエンジンのバージョンのリリースノートを読み、ゲームに影響を与える可能性のある大きな変更点やアップグレードノートを確実に把握する必要があります。
1. 新しいバージョンのエンジンをダウンロードしてインストールします。(understanding-the-basics/installing-unreal-engine)  
   古いバージョンと新しいバージョンを比較できるように、現在のエンジン バージョンとは別のディレクトリにインストールした方がよいかもしれません。
1. エンジンの新バージョンと一致する Lyra Starter Game sample の新バージョンをダウンロードしてインストールし、どのように更新されたかを確認できるようにします。  
   これを別のディレクトリにインストールすれば、旧バージョンと比較することができます。
1. Unreal Engine 5 移行ガイド を参照し、最新バージョンのエンジンとの互換性を確認します。
1. C++ コードエディターでプロジェクトをロードし、コンパイルを試みます。これはおそらく失敗するでしょう。
1. 非推奨の警告が表示された場合は、非推奨のメッセージに含まれる手順を使用して修正します。
1. クラスや構造体が無効または見つからないというエラーについては、ファイルの先頭に新しい `#include` 行を追加する必要があります。  
   Visual Studio を使用している場合は、 **編集 > 検索と置換 > ファイルの検索** で、不足している型名を検索できます。  
   その型を定義しているヘッダーファイルを探して、新しい `#include`を追加します。
1. 仮想関数のオーバーライドに関するエラーの場合、ヘッダーファイルと `.cpp` ファイルの両方でオーバーライドされた関数のパラメータを更新する必要があります。
1. クラスや構造体の無効な変数に関するエラーは、その変数にアクセスするための別の方法を使用する必要があります。  
   これは通常、実際の値を返す `Get()` や `GetVariableName()` などのアクセッサ関数を呼び出すことで解決します。
1. エラーを修正する方法がわからない場合は、リリースノートを検索するか、コミュニティフォーラムで詳細を確認してください。

Lyra Starter Game の古いバージョンと新しいバージョンを比較することで、ソースコードへの複雑な変更をどのように扱うかを知ることができます。 
以下のバージョン固有の情報は、あなたのゲームに Lyra のコードやコンテンツが含まれている場合、それをアップグレードするのに役立つことでしょう。


# Unreal Engine 5.1

Unreal Engine 5.1 では、 Lyra Sample Game がアップデートされ、サンプルに関する問題の修正とエンジンに追加された最新機能の利用が可能になりました。

## Upgrade Notes for 5.1:

* いくつかのエンジンヘッダは、コンパイル時間を短縮するために再編成されました。  
  これは、 Lyra のソースファイルに関するいくつかの問題を露呈させました。  
  これらの問題は、ヘッダーに `#pragma once` 行を追加し、シンボルがないソースファイルに `#include EditorStyle.h` を追加することで修正することが可能です。
* ゲームプレイフレームワーククラスのいくつかの生ポインタプロパティは、 `TObjectPtr` または `TWeakObjectPtr` を使用するように変更されました。  
  生ポインタを必要とするコードは、 `Get()` 関数への呼び出しを追加することで修正できます。
* `ENSURE_ABILITY_IS_INSTANTIATED_OR_RETURN` マクロが `GameplayAbility.h` から削除されました。  
  このマクロは `GameplayAbility.cpp` から他のアビリティのソースコードファイルにコピーすることができます。
* ゲームフィーチャープラグインに関連するいくつかの仮想関数が修正され、新しいパラメータが追加されました。  
  `ULyraGameFeaturePolicy` などのクラスでオーバーライドされた関数は、更新する必要があります。
* ジオメトリメッシュブループリント `Tools/BakedGeneratedMeshSystem/BaseClasses/BakedGeneratedMeshActor` は 5.1 用に更新されました。  
  5.0 のアセットも引き続き機能しますが、5.1 バージョンを使用しないと Nanite 設定が正しく設定されません。

## Improvements in 5.1:

* `LyraHeroComponent` と `LyraPawnExtensionComponent` におけるポーン初期化フローは、新しい `IGameFrameworkInitStateInterface` と `GameFrameworkComponentManager` 上の Init State システムを使用するように書き換えられました。 
  これにより、ネットワークレプリケーションにおけるいくつかの競合状態が修正され、新しい機能に特化したコンポーネントで拡張することが容易になりました。
* 異なる機能を持つデバイスのための Android デバイスプロファイルを追加し、他のプラットフォーム設定を調整しました。
* エディタツールバーに一般的なマップをロードするためのUIを追加しました。
* Epic Online Services を使用したマルチプレイヤーゲームへの招待に関する基本的な処理を追加しました。
* 新たなプラグイン ShooterExplorer と ShooterTest にプロトタイプとテスト用のコンテンツを追加しました。
* すでに割り当てられているキーをバインドする際に、警告画面を表示するように改善されました。

## Bug Fixes in 5.1:

* `LyraGame.Target.cs` の `ShouldEnableAllGameFeaturePlugins` 関数は `false` を返すように変更され、これはゲームフィーチャープラグインが通常のプラグインのように有効になることを意味します。 
  これにより、エンジンのカスタムコンパイル版とランチャーインストール版の両方で、プラグインが同じように動作するように修正されました。
* Lyra を実行すると、他のプロジェクトで Play In Editor を終了するためのキーバインドが変更される問題を修正しました。
* アビリティがヘルスにネガティブモディファイアを適用する代わりに、ヒーリングとダメージのアトリビュートを適切に使用するように変更しました。
* 非推奨のコントローラ ID の代わりに、新しい PlatformUser と InputDeviceId タイプを使用するようにコードとブループリントを更新しました。

# Unreal Engine 5.0

Lyra Sample Game の 5.0 バージョンは、オリジナルのリリースにあったいくつかのバグを修正するために 5.0.2 とともにアップデートされました。  
これらの修正は、それ以降のすべてのサンプルのリリースに含まれています。

## Bug Fixes in 5.0.2:

* 異なるインストールディレクトリを扱う自動化スクリプトを修正しました。
* マウスを反転させる設定を修正しました。
* マネキンのリターゲティングとコントロールリグのアセットを更新しました。
* モバイルデバイスプロファイルのアンチエイリアス設定を更新しました。
* 不足していたエディタアイコンを追加しました。


<!--- ページ内のリンク --->
[Unreal Engine 5.1 Documentation > サンプルとチュートリアル > サンプル ゲーム プロジェクト > Lyra サンプル ゲーム > Upgrading the Lyra Starter Game to the Latest Engine Release]: https://docs.unrealengine.com/5.1/ja/upgrading-the-lyra-starter-game-to-the-latest-engine-release-in-unreal-engine/

<!--- 自前の画像へのリンク --->

<!--- generated --->
